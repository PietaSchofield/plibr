#' display datatable 
#'
#' displays a datatable (DT) either as raw tibble if not compiling to avoid trying to fire up unnecessary
#' browers or as a DT if rendering to html
#' 
#' @param dataset the data to display
#' @param number the maxium number of rows to display
#' @param disp the flag which decides the whole shebang
#' @param limited contrain to container
#'
#' @export
<<<<<<< HEAD
display_data <- function(dataset,number=NULL,disp=F,limited=F,buttons=F,plen=NULL,
                         caption=NULL){
=======
display_data <- function(dataset,number=NULL,disp=F,limited=F,buttons=F,plen=NULL,caption=NULL){
>>>>>>> f2b69e9eda405b015719f6c7023e5ef7bc8b81f6
  if(!is.null(number)){
    dataset <- dataset %>% tibble::as_tibble() %>% head(number) 
  }
  if(is.null(plen)){
    plen=10
  }else if(!is.numeric(plen)){
    plen=nrow(dataset)
  }
  if(disp){
    if(buttons){
      ext <- 'Buttons'
      btns <- c("copy","csv")
      dom <- 'Blfrtip'
      dataset %>% DT::datatable(extensions = ext, 
                                caption=caption,
                              options = list(dom = dom, 
                                             buttons = btns, 
                                             lengthMenu = list(c(10,50,100, -1), 
                                                               c('10', '50', '100', 'All')),
                                             paging = T,
                                             scrollX = T,
                                             pageLength = plen),
                              fillContainer=limited,escape=F,rownames=F)
    }else{
      dom <- 'lfrtip'
<<<<<<< HEAD
      dataset %>% DT::datatable( caption=caption, options = list(dom = dom, 
=======
      dataset %>% DT::datatable(caption=caption, options = list(dom = dom, 
>>>>>>> f2b69e9eda405b015719f6c7023e5ef7bc8b81f6
                                             lengthMenu = list(c(10,50,100, -1), 
                                                               c('10', '50', '100', 'All')),
                                             paging = T,
                                             scrollX = T,
                                             pageLength = plen),
                              fillContainer=limited,escape=F,rownames=F)
    }
}else{
    dataset %>% tibble::as_tibble()
  }
}
